# Regression_Cox_CCD_Screening
Le but de ce code est d'exécuter d'implémeter l'algorithme de régression de Cox avec la methode dichotomie ccyclique (Cyclic Coordinate Descent) précédé d'une phase de
de recherche des intervalles de valeurs (Cyclic Coordinate Bounds) et pouvant etre précédé d'une phase de de screening dans le cas de l'ajout d'une pénalisation de lasso.
Les données proviennent du All Lending Club 2007 à 2018  : En tout un million de données disponible sur [Kaggle](https://www.kaggle.com/datasets/wordsforthewise/lending-club?resource=download ) et ayant servi en parti (15 000 point de données) dans le document <<Solving Cox proportionnal Hazards Model and Its Applications>> pour effectuer une implémentation de la Régression de Cox avec Screening  . Le data set retenu pour le training et le test est ici  de 30 000 données et est contenu dans le fichier loan.csv .
  
  Le CCB a été implémenté par la fonction CCB(Limite,fonction,indice,beta_prime) prenant en entrée Limite : l'amplitude maximale de l'intervalle des valeurs possibles,
  fonction : la fonction  pour laquelle l'intervalle doit etre trouvée, indice : de 0 à dim(beta)-1 la dimension sur laquelle on veut trouver l'intervalle et beta_prime : le vecteur beta initiale . Cette fonction renvoie deux vecteurs de meme dimension que beta_prime , L(Lower) et U(Upper) qui contiennent les mêmes valeur que beta_prime sauf à la position indice +1 qui contient pour la borne inféreure et pour U la borne suppérieure de l'intervalle.
  
  Le CCD a été implémenté par les fonctions CCD et CCDF. La fonction CCD correspondant à une descente de coordonnées cycliques sur une même fonction tandis que la fonction CCDF correspond à la descente decoordonnées  cyclique sur un  ensmble de fonctions(comme l'ensemble des dérivées partielles) plus approprié dans notre cas. 
  Les arguments de la fonction sont : error_max: l'erreur maximale sur les valeurs des racines de la fonctions à calculer,Iter_Max : le nombre d'itération maximale sur les boucles de convergence de la méthode,Limite_ini : la limite initiale pour l'intervalle des valeurs dans la fonction CCB ,fonction : la fonction ou l'ensemble des fonctions sur lesquelles la descente de coordonnées sera appliquée  ,size :  la dimension du vecteur beta et aussi de l'ensemble des fonctions dont on veut calculer les racines (ici le gradient de la NLL) ,flags : un vecteur  flag  de dimension size permettant au indice ou  sa valeur est mise à 1 de ne pas mettre avoir à calculer les racines. Cela permettra de faire le lien avec le module de screening qui sera exécuté préalablement pour déterminer quels indices de beta sont nul et donc  calculer le vecteur flags.
  
  
  La dérivée de  Negetaive Likelihood a maximiser ici a été  implémenté par la fonction Derivate_unique(betas,indice) prenant en argumant beta : la valeur actuelle des paramètres et indice : l'indice pour lequel la dérivée partielle est calculée. Cette fonction rencoie donc la dérivée patielle de la NLL suivant la varaible $beta_i$ en betas.Avant d'implémenter cette fonction , des opérations de  préprocessing (Chargement de certaines features retenues dans l'étude initiales, Calcul du time event et du death indicator,numérisation des labels,MinMax Scaler) ont été appliquées.
  
  Le problème actuelle réside dans la non convergence des  fonctins CCB et CCD vers les racines , provenant après test des mauvais intervalles de valeurs trouvées par la fonction CCB. 
